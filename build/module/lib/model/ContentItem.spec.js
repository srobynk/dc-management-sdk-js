import test from 'ava';
import { MockDynamicContent } from '../DynamicContent.mocks';
import { ContentItem } from './ContentItem';
test('get content item by id', async (t) => {
    const client = new MockDynamicContent();
    const result = await client.contentItems.get('a87fd535-fb25-44ee-b687-0db72bbab721');
    t.is(result.label, 'Banner Ad Homepage');
});
test('get version', async (t) => {
    const client = new MockDynamicContent();
    const contentItem = await client.contentItems.get('a87fd535-fb25-44ee-b687-0db72bbab721');
    const version1 = await contentItem.related.contentItemVersion(1);
    t.is(version1.version, 1);
});
test('update', async (t) => {
    const client = new MockDynamicContent();
    const contentItem = await client.contentItems.get('a87fd535-fb25-44ee-b687-0db72bbab721');
    const mutation = new ContentItem({
        label: 'New Label',
        version: contentItem.version
    });
    const update = await contentItem.related.update(mutation);
    t.is(update.version, contentItem.version + 1);
});
test('get repository', async (t) => {
    const client = new MockDynamicContent();
    const contentItem = await client.contentItems.get('a87fd535-fb25-44ee-b687-0db72bbab721');
    const repo = await contentItem.related.contentRepository();
    t.is(repo.name, 'inspiration');
});
test('set locale', async (t) => {
    const client = new MockDynamicContent();
    const contentItem = await client.contentItems.get('a87fd535-fb25-44ee-b687-0db72bbab721');
    const itemWithLocale = await contentItem.related.setLocale('en-GB');
    t.is(itemWithLocale.locale, 'en-GB');
});
test('create localizations', async (t) => {
    const client = new MockDynamicContent();
    const contentItem = await client.contentItems.get('a87fd535-fb25-44ee-b687-0db72bbab721');
    const itemWithLocale = await contentItem.related.setLocale('en-GB');
    const localizationJob = await itemWithLocale.related.localize(['fr-FR']);
    t.is(localizationJob.status, 'IN_PROGRESS');
});
test('toJSON should copy resource attributes', async (t) => {
    const client = new MockDynamicContent();
    const resource = await client.contentItems.get('a87fd535-fb25-44ee-b687-0db72bbab721');
    t.deepEqual(resource.toJSON(), {
        body: {
            _meta: {
                name: 'main-banner',
                schema: 'http://deliver.bigcontent.io/schema/nested/nested-type.json'
            }
        },
        createdBy: 'user',
        createdDate: '2018-06-26T12:54:16.216Z',
        deliveryId: 'a87fd535-fb25-44ee-b687-0db72bbab721',
        folderId: '5b3237784cedfd01c4503658',
        id: 'a87fd535-fb25-44ee-b687-0db72bbab721',
        label: 'Banner Ad Homepage',
        lastModifiedBy: 'user',
        lastModifiedDate: '2018-06-26T12:54:16.216Z',
        locale: 'en-GB',
        status: 'ACTIVE',
        version: 1
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29udGVudEl0ZW0uc3BlYy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9saWIvbW9kZWwvQ29udGVudEl0ZW0uc3BlYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLElBQUksTUFBTSxLQUFLLENBQUM7QUFDdkIsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDN0QsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUU1QyxJQUFJLENBQUMsd0JBQXdCLEVBQUUsS0FBSyxFQUFDLENBQUMsRUFBQyxFQUFFO0lBQ3ZDLE1BQU0sTUFBTSxHQUFHLElBQUksa0JBQWtCLEVBQUUsQ0FBQztJQUN4QyxNQUFNLE1BQU0sR0FBRyxNQUFNLE1BQU0sQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUMxQyxzQ0FBc0MsQ0FDdkMsQ0FBQztJQUNGLENBQUMsQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxvQkFBb0IsQ0FBQyxDQUFDO0FBQzNDLENBQUMsQ0FBQyxDQUFDO0FBRUgsSUFBSSxDQUFDLGFBQWEsRUFBRSxLQUFLLEVBQUMsQ0FBQyxFQUFDLEVBQUU7SUFDNUIsTUFBTSxNQUFNLEdBQUcsSUFBSSxrQkFBa0IsRUFBRSxDQUFDO0lBRXhDLE1BQU0sV0FBVyxHQUFHLE1BQU0sTUFBTSxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQy9DLHNDQUFzQyxDQUN2QyxDQUFDO0lBQ0YsTUFBTSxRQUFRLEdBQUcsTUFBTSxXQUFXLENBQUMsT0FBTyxDQUFDLGtCQUFrQixDQUFDLENBQUMsQ0FBQyxDQUFDO0lBRWpFLENBQUMsQ0FBQyxFQUFFLENBQUMsUUFBUSxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUMsQ0FBQztBQUM1QixDQUFDLENBQUMsQ0FBQztBQUVILElBQUksQ0FBQyxRQUFRLEVBQUUsS0FBSyxFQUFDLENBQUMsRUFBQyxFQUFFO0lBQ3ZCLE1BQU0sTUFBTSxH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