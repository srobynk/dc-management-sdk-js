import test from 'ava';
import { HttpMethod } from '../../..';
import { AxiosHttpClient } from '../../http/AxiosHttpClient';
import { HttpError } from '../../http/HttpError';
import { ContentRepository } from '../../model/ContentRepository';
import { Hub } from '../../model/Hub';
import { DefaultHalClient } from './HalClient';
// axios-mock-adaptor's typedefs are wrong preventing calling onGet with 3 args, this is a workaround
/**
 * @hidden
 */
// tslint:disable-next-line
const MockAdapter = require('axios-mock-adapter');
/**
 * @hidden
 */
function createMockClient() {
    const httpClient = new AxiosHttpClient({});
    const client = new DefaultHalClient('', httpClient, tokenProvider);
    const mock = new MockAdapter(httpClient.client);
    return [client, mock];
}
/**
 * @hidden
 */
const tokenProvider = {
    getToken: () => Promise.resolve({
        access_token: 'token',
        expires_in: 500,
        refresh_token: 'refresh'
    })
};
test('fetchResource should load and parse resource', async (t) => {
    const [client, mock] = createMockClient();
    mock.onGet('/hubs/1').reply(200, {
        name: 'hub 1'
    });
    const hub = await client.fetchResource('/hubs/1', Hub);
    t.is(hub.name, 'hub 1');
});
test('fetchLinkedResource should follow href', async (t) => {
    const [client, mock] = createMockClient();
    mock.onGet('/hubs/1').reply(200, {
        name: 'hub 1'
    });
    const hub = await client.fetchLinkedResource({ href: '/hubs/1' }, {}, Hub);
    t.is(hub.name, 'hub 1');
});
test('fetchLinkedResource should process templated links', async (t) => {
    const [client, mock] = createMockClient();
    mock.onGet('/hubs/1').reply(200, {
        name: 'hub 1'
    });
    const hub = await client.fetchLinkedResource({ href: '/hubs/{id}', templated: true }, { id: '1' }, Hub);
    t.is(hub.name, 'hub 1');
});
test('createResource should post and parse the resource', async (t) => {
    const [client, mock] = createMockClient();
    mock.onPost('/hubs').reply(200, {
        id: 'hub 1',
        name: 'hub 1'
    });
    let hub = new Hub();
    hub.name = 'hub 1';
    hub = await client.createResource('/hubs', hub, Hub);
    t.is(hub.id, 'hub 1');
});
test('createLinkedResource should follow href', async (t) => {
    const [client, mock] = createMockClient();
    mock.onPost('/hubs').reply(200, {
        id: 'hub 1',
        name: 'hub 1'
    });
    let hub = new Hub();
    hub.name = 'hub 1';
    hub = await client.createLinkedResource({ href: '/hubs' }, {}, hub, Hub);
    t.is(hub.id, 'hub 1');
});
test('createLinkedResource should process templated links', async (t) => {
    const [client, mock] = createMockClient();
    mock.onPost('/hubs/1/content-repositories').reply(200, {
        id: 'repo 1',
        name: 'repo 1'
    });
    let repo = new ContentRepository();
    repo.name = 'repo 1';
    repo = await client.createLinkedResource({ href: '/hubs/{id}/content-repositories', templated: true }, { id: '1' }, repo, ContentRepository);
    t.is(repo.id, 'repo 1');
});
test('requests should include auth token', async (t) => {
    const [client, mock] = createMockClient();
    mock
        .onGet('/hubs/1', undefined, {
        Accept: 'application/json, text/plain, */*',
        Authorization: 'bearer token'
    })
        .reply(200, {
        name: 'hub 1'
    });
    const hub = await client.fetchResource('/hubs/1', Hub);
    t.is(hub.name, 'hub 1');
});
test('should ask for token from provider every request', async (t) => {
    const httpClient = new AxiosHttpClient({});
    let tokenCount = 0;
    const client = new DefaultHalClient('', httpClient, {
        getToken: () => Promise.resolve({
            access_token: 'token' + tokenCount++,
            expires_in: 500,
            refresh_token: 'refresh'
        })
    });
    const mock = new MockAdapter(httpClient.client);
    mock
        .onGet('/hubs/1', undefined, {
        Accept: 'application/json, text/plain, */*',
        Authorization: 'bearer token0'
    })
        .reply(200, {
        name: 'hub 1'
    });
    mock
        .onGet('/hubs/1', undefined, {
        Accept: 'application/json, text/plain, */*',
        Authorization: 'bearer token1'
    })
        .reply(200, {
        name: 'hub 1'
    });
    const hub = await client.fetchResource('/hubs/1', Hub);
    const hub2 = await client.fetchResource('/hubs/1', Hub);
    t.is(hub2.name, 'hub 1');
});
test('parse should instantiate and parse the resource', t => {
    const [client, mock] = createMockClient();
    const hub = client.parse({ name: 'hub' }, Hub);
    t.is(hub.name, 'hub');
});
test('serialize should make a copy of the object', t => {
    const [client, mock] = createMockClient();
    const hub = new Hub();
    hub.name = 'hub';
    const hubJson = client.serialize(hub);
    t.not(hub, hubJson);
    t.is(hubJson.name, 'hub');
});
test('api errors should be surfaced in the rejection error', async (t) => {
    const [client, mock] = createMockClient();
    mock
        .onGet('/hubs/1', undefined, {
        Accept: 'application/json, text/plain, */*',
        Authorization: 'bearer token'
    })
        .reply(403, {
        errors: [{ message: 'Authorization Required' }]
    });
    const error = await t.throws(async () => client.fetchResource('/hubs/1', Hub), HttpError);
    t.deepEqual(error.request, {
        data: undefined,
        headers: {
            Authorization: 'bearer token'
        },
        method: HttpMethod.GET,
        url: '/hubs/1'
    });
    t.deepEqual(error.response, {
        data: {
            errors: [{ message: 'Authorization Required' }]
        },
        status: 403
    });
    t.is(error.message, 'Request failed with status code 403: {"errors":[{"message":"Authorization Required"}]}');
});
test('unknown errors should describe the status code', async (t) => {
    const [client, mock] = createMockClient();
    mock
        .onGet('/hubs/1', undefined, {
        Accept: 'application/json, text/plain, */*',
        Authorization: 'bearer token'
    })
        .reply(403, {
        errors: [{ message: 'Authorization Required' }]
    });
    const error = await t.throws(async () => client.fetchResource('/hubs/1', Hub), HttpError);
    t.deepEqual(error.request, {
        data: undefined,
        headers: {
            Authorization: 'bearer token'
        },
        method: HttpMethod.GET,
        url: '/hubs/1'
    });
    t.deepEqual(error.response, {
        data: {
            errors: [{ message: 'Authorization Required' }]
        },
        status: 403
    });
    t.is(error.message, 'Request failed with status code 403: {"errors":[{"message":"Authorization Required"}]}');
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSGFsQ2xpZW50LnNwZWMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvbGliL2hhbC9zZXJ2aWNlcy9IYWxDbGllbnQuc3BlYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLElBQUksTUFBTSxLQUFLLENBQUM7QUFDdkIsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUN0QyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDN0QsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ2pELE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBQ2xFLE9BQU8sRUFBRSxHQUFHLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUN0QyxPQUFPLEVBQUUsZ0JBQWdCLEVBQWEsTUFBTSxhQUFhLENBQUM7QUFFMUQscUdBQXFHO0FBQ3JHOztHQUVHO0FBQ0gsMkJBQTJCO0FBQzNCLE1BQU0sV0FBVyxHQUFHLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO0FBRWxEOztHQUVHO0FBQ0g7SUFDRSxNQUFNLFVBQVUsR0FBRyxJQUFJLGVBQWUsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUMzQyxNQUFNLE1BQU0sR0FBRyxJQUFJLGdCQUFnQixDQUFDLEVBQUUsRUFBRSxVQUFVLEVBQUUsYUFBYSxDQUFDLENBQUM7SUFDbkUsTUFBTSxJQUFJLEdBQUcsSUFBSSxXQUFXLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBRWhELE9BQU8sQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDeEIsQ0FBQztBQUVEOztHQUVHO0FBQ0gsTUFBTSxhQUFhLEdBQUc7SUFDcEIsUUFBUSxFQUFFLEdBQUcsRUFBRSxDQUNiLE9BQU8sQ0FBQyxPQUFPLENBQUM7UUFDZCxZQUFZLEVBQUUsT0FBTztRQUNyQixVQUFVLEVBQUUsR0FBRztRQUNm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